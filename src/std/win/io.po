namespace std
{
    static u32 readLine(u8* buffer, u32 size)
    {
        u32 stdIn = (u32)4294967286;
        if (size == (u32)0)
        {
            return (u32)0; // Invalid buffer or size
        }
        u32 bytesRead = (u32)0;
        i64 handle = GetStdHandle(stdIn);
        ReadFile(handle,
            buffer,
            size - (u32)1,
            &bytesRead,
            null);
        u8[] buf = (u8[128])buffer;
        if (bytesRead > (u32)0 && buf[(i64)bytesRead - (i64)1] == 10b)
        {
            bytesRead -= (u32)1; // Remove newline character
        }
        buf[(i64)bytesRead] = 0b; // Null-terminate the string
        return bytesRead;
    }

    static void print(u8* str, u32 size)
    {
        u32 stdOut = (u32)4294967285;

        u32 bytesWritten = (u32)0;
        i64 handle = GetStdHandle(stdOut);
        WriteFile(handle,
            str,
            size,
            &bytesWritten,
            null);
    }

    //static void println()
    //{
    //    u32 stdOut = (u32)4294967285;
    //    
    //    u32 bytesWritten = (u32)0;
    //    i64 handle = GetStdHandle(stdOut);
    //    
    //    u8[2] newline;
    //    newline[0] = 10b;
    //    newline[1] = 0b;
    //    
    //    WriteFile(handle,
    //        (u8*)newline,
    //        (u32)2,
    //        &bytesWritten,
    //        null);
    //}

    static void println(u8* str, u32 size)
    {
        u32 stdOut = (u32)4294967285;

        u32 bytesWritten = (u32)0;
        i64 handle = GetStdHandle(stdOut);
        WriteFile(handle,
            str,
            size,
            &bytesWritten,
            null);

        u8[2] newline;
        newline[0] = 10b;
        newline[1] = 0b;

        WriteFile(handle,
            (u8*)newline,
            (u32)2,
            &bytesWritten,
            null);
    }

    static void print_64(i64 value)
    {
        u8[128] buffer;
        u32 size = toString(value, (u8*)buffer, (u32)128);
        print((u8*)buffer, size);
    }
}
